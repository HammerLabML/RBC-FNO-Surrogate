# Solving Turbulent Rayleigh-Bénard Convection using Fourier Neural Operators

<a href="https://pytorch.org/get-started/locally/"><img alt="PyTorch" src="https://img.shields.io/badge/PyTorch-ee4c2c?logo=pytorch&logoColor=white"></a>
<a href="https://hydra.cc/"><img alt="Config: Hydra" src="https://img.shields.io/badge/Config-Hydra-89b8cd"></a>
[![Paper](http://img.shields.io/badge/Arxiv-todo-red)](#rbc-fno-surrogate)
[![Conference](http://img.shields.io/badge/Conference-todo-blue)](#rbc-fno-surrogate)


# Work in progress for Neurocomputing submission


## Abstract
Data-driven surrogate models provide fast and fully differentiable approximations of complex dynamical systems. In this work, we develop such surrogates for the Rayleigh–Bénard convection (RBC), which governs thermally driven flows in natural and industrial environments. Specifically, the proposed models approximate the discrete-time flow map of the RBC system, advancing the full system state by a fixed time step. We train Fourier Neural Operator (FNO)–based models to learn the dynamics of RBC in two and three dimensions and compare them to a convolutional U-Net baseline and a Koopman-based Linear Recurrent Autoencoder Network (LRAN). The two-dimensional system serves as a baseline for the more challenging three-dimensional case, which exhibits increased spatial complexity and turbulent dynamics. Across all settings, FNO-based models consistently outperform the LRAN, while achieving performance comparable to the U-Net in several regimes. Incorporating spatio-temporal inputs via FNOs leads to improved long-term prediction accuracy, particularly for turbulent flows. The physical fidelity of the predictions is assessed using convective heat flux statistics, profiles, and fluctuations, showing that FNOs most closely reproduce the ground-truth flow statistics. In addition, we demonstrate that FNOs enable zero-shot super-resolution across unseen spatial discretizations, a capability not shared by the convolutional baselines. These results highlight the potential of neural operator–based models as accurate, physically consistent, and resolution-independent surrogates for downstream tasks such as flow control.

## Rayleigh-Bénard Convection
This work uses Fourier Neural Operators to model Rayleigh-Bénard Convection (RBC). RBC describes convection processes in a layer of fluid cooled from the top and heated from the bottom via the partial differential equations:

**Rayleigh-Bénard Convection**

$$\begin{aligned}
& \frac{\partial u}{\partial t} + (u \cdot \nabla) u = -\nabla p + \sqrt{\frac{Pr}{Ra}} \nabla^2 u + T j \\
& \frac{\partial T}{\partial t} + u \cdot \nabla T = \frac{1}{\sqrt{Ra Pr}} \nabla^2 T\ \\
& \nabla \cdot u = 0 \\
\end{aligned}$$

The surrogate models are trained on data generated by a Direct Numerical Simulation based on [Oceananigans]() with the following parameters:
| Parameter     | 2D                  | 3D              |
|-----------    |---------------------|-----------------|
| Domain **D**  | 2π × 2              | 4π × 4π × 2      |
| Grid **N**    | 96 × 64             | 48 × 48 × 32     |
| Ra            | [3 · 10⁵ – 10⁷]     | 2500            |
| Pr            | 0.7                 | 0.7             |
| (T_C, T_H)    | (1, 2)              | (0, 1)          |
| Δt            | 0.03                | 0.01            |


## Citation
If you find our work useful, please cite us via:

```bibtex
@article{todo,
  title={},
  author={},
  journal={},
  year={}
}

```

## Setup
We use [uv](https://docs.astral.sh/uv/) to manage python dependencies.
```bash
uv sync
```
Alternatively, you can use virtual environments and install this package. Dependencies are given in pyproject.toml.

## How to
### FNO Training
```bash
uv run python scripts/train_3d_rbc.py
```
